import { useEffect, useState } from 'react';
import { Navbar } from '../../Compoents/Navbar/Navbar';
import { Task } from '../../Compoents/Task/task';
import { useAuth } from '../../Hooks/useAuth';
import { getTasks } from '../../services/api';
import { DashboardView } from './style';

export function DashboardPage() {
  const { logout, user } = useAuth();
  const [tasks, setTasks] = useState([]);

  useEffect(() => {
    (async function () {
      const response = await getTasks(user.id);
      setTasks(response.data.tasks);
    })();
  }, []);

  return (
    <>
      <Navbar options={[{ name: 'Logout', goTo: '/', onclick: logout }]} />
      <div className="default-container">
        <DashboardView>
          <div className="dashboard-heading">
            <h1>My Tasks</h1>
          </div>
          <div className="dashboard-body">
            {tasks.map(task => (
              <Task task={task} key={task._id}/>
            ))}
          </div>
        </DashboardView>
      </div>
    </>
  );
}
